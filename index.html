<script>
async function searchExam() {
  const query = document.getElementById("search").value.toLowerCase();

  const res = await fetch("https://script.google.com/macros/s/AKfycbwGv9nmWP7AWXVKOXwPYOKsI2wtOa6QXYIB8UDgBZdSOJDYLkUlWWr-2gQC2WU1ul_IgA/exec");
  const data = await res.json();

  let output = "";

  for (let i = 1; i < data.length; i++) {
    if (data[i][0].toLowerCase().includes(query)) {
      output += `
        <div class="card">
          <h3>${data[i][0]} - ${data[i][1]}</h3>
          <p>Category: ${data[i][3]}</p>
          <a href="${data[i][2]}" target="_blank">Download PDF</a>
        </div>
      `;
    }
  }

  document.getElementById("results").innerHTML = output;
}
</script>
